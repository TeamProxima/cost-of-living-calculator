{% block content %}
<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>Proxima</title>




        <style>
      @import url(http://fonts.googleapis.com/css?family=Exo:100,200,400);
      @import url(http://fonts.googleapis.com/css?family=Source+Sans+Pro:700,400,300);

body{
    margin: 0;
    padding: 0;
    background: #fff;
    color: #fff;
    font-family: 'Exo', sans-serif;
    font-size: 12px;
}

.body{
    position: absolute;
    top: -20px;
    left: -20px;
    right: -40px;
    bottom: -40px;
    width: 1440px;
    height: 720px;
    background-image: url(https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQIBO1Bq4W6VsDaE37z985u8sbegr4Ead4-oCXVtOh7s9M3fUao);
    background-size: cover;
    -webkit-filter: blur(5px);
    z-index: -1;
}

input[type=text]{
    width: 250px;
    height: 30px;
    background: transparent;
    border: 1px solid rgba(255,255,255,0.6);
    border-radius: 2px;
    color: #a18d6c;
    font-family: 'Exo', sans-serif;
    font-size: 16px;
    font-weight: 400;
    padding: 4px;
}

input[type=button]{
    width: 140px;
    height: 35px;
    background: #fff;
    border: 1px solid #fff;
    cursor: pointer;
    border-radius: 2px;
    color: #a18d6c;
    font-family: 'Exo', sans-serif;
    font-size: 16px;
    font-weight: 400;
    padding: 6px;
    margin-top: 10px;
}


input[type=text]:focus{
    outline: none;
    border: 1px solid rgba(255,255,255,0.9);
}


::-webkit-input-placeholder{
   color: rgba(255,255,255,0.6);
}

::-moz-input-placeholder{
   color: rgba(255,255,255,0.6);
}

select {
    width: 260px;
    height: 35px;
    background: #fff;
    border: 1px solid #fff;
    cursor: pointer;
    border-radius: 2px;
    color: #a18d6c;
    font-family: 'Exo', sans-serif;
    font-size: 16px;
    font-weight: 400;
    padding: 6px;
    margin-top: 10px;
    -webkit-appearance: none;
   }
}

</style>

{% load staticfiles %}
<script type="text/javascript" src="http://code.jquery.com/jquery-2.2.0.min.js"></script>
<script type="text/javascript" src="http://cdn.jsdelivr.net/jquery.cookie/1.4.1/jquery.cookie.min.js"></script>
<link href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css' rel='stylesheet' type='text/css'>
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

  <body>
<div class="body"></div>
{% if message %}
<p id='question'>{{message}}</p>
{% endif %}
<div id="slider"></div>

{% if questions %}
   There are {{ questions|length }} question(s) in this category:
   {% for q in questions %}

       <div style="background-color:lightblue; color:white; padding:20px; border-style: solid; border-color: red;">
            <h2>{{ q.text }}</h2>

            {% if q.type == 0 %}
                <form action="">
                {% for a in q.alt %}
                  <input class="answer" type="radio" name="alt" value="{{ a }}"> "{{ a }}" <br>
                {% endfor %}
                </form>
            {% endif %}

           {% if q.type == 1 %}
                  <input class="answer" type="text" name="text"><br>
           {% endif %}

           {% if q.type == 2 %}
                <form action="">
                    <select class="answer">
                        {% for o in q.opt %}
                            <option value="{{ o }}"">"{{ o }}"</option>
                        {% endfor %}
                    </select>
                </form>
           {% endif %}

           {% if q.type == 3 %}
                <label for="number">Number</label>
                    <select name="number" id="number">
                        {% for i in q.range %}
                          <option>{{ i }}</option>
                        {% endfor %}
                    </select>
            {% endif %}
       </div>
   {% endfor %}
{% else %}
   There are no questions in the system.
{% endif %}

<input id='submit' type="button" value='Next' onclick ='sendAJAX();'/>

<script>

//--------------------------------------------VARIABLES---------------------------------------------//


//-----------------------------------------BUTTON CLICK FUNCTIONS------------------------------------//

{
    $(function() {
        var select = $( "#number" );
        var slider = $( "<div id='slider'></div>" ).insertAfter( select ).slider({
            min: 1,
            max: 6,
            range: "min",
            value: select[ 0 ].selectedIndex + 1,
            slide: function( event, ui ) {
            select[ 0 ].selectedIndex = ui.value - 1;
            }
        });
        $( "#number" ).change(function() {
          slider.slider( "value", this.selectedIndex + 1 );
        });
     });


    function prepareAnswers() {
        answers = [];
        $(".answer").each(function() {
            if($(this).attr('type') == 'radio') {
                console.log('CHECKED');
                if($(this).is(":checked"))
                    answers.push($(this).val());
            }
            else
                answers.push($(this).val());
        });
        return {ANS: answers};
    }

    function sendAJAX() {

        var csrftoken = $.cookie('csrftoken');

        function csrfSafeMethod(method) {
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain)
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        });


        $.ajax({
            traditional: true, type: 'POST', url: '/questions',
            data: {answers: JSON.stringify(prepareAnswers())},

            success: function (data) {
                response = data;
                console.log('ADADASDAS')
            },
            failed: function (data) {
                onsole.log(data);
                alert("Error!");
            }
        });
    }
}


//-----------------------------------------KEY PRESS FUNCTIONS------------------------------------//

{
    function moveSelection(evt) {
        if(evt.keyCode < 41 && evt.keyCode > 36) {
            OPname = 'CHANGE'
            switch (evt.keyCode) {
                case 38:
                    baseSight = [Math.max(0, baseSight[0] - 10), baseSight[1]];
                    break;
                case 40:
                    baseSight = [Math.min(baseSight[0] + 10, 100), baseSight[1]];
                    break;
                case 37:
                    baseSight = [baseSight[0], Math.max(0, baseSight[1] - 10)];
                    break;
                case 39:
                    baseSight = [baseSight[0], Math.min(baseSight[1] + 10, 100)];
                    break;
            }
            sendAJAX();
        }

    };
    window.addEventListener('keydown', moveSelection);
}



</script>

</div>
</body>
</html>
{% endblock %}